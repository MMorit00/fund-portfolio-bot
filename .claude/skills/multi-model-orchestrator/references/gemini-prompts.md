# Gemini Prompt 模板库

专门用于 Gemini 模型的 prompt 模板，充分利用其 1M 上下文能力。

**核心原则：要求完整分析，不要求精简**

---

## 基础分析

### 架构分析

```
分析以下代码文件的架构关系：

{files_content}

请详细分析：
1. 文件依赖关系（包括 import 和调用点）
2. 数据流向（输入 → 处理 → 输出，标注关键函数）
3. 核心抽象和接口
4. 潜在问题或改进点

请给出完整分析，包含文件路径和行号。
```

### 代码解释

```
解释以下代码的核心逻辑：

{code_content}

请说明：
1. 主要功能和设计目的
2. 关键算法/设计模式的工作原理
3. 重要边界情况和错误处理
4. 与其他模块的交互方式

请保留所有重要细节。
```

### 依赖分析

```
分析以下模块的依赖关系：

{module_content}

请列出：
1. 外部依赖（第三方库）及用途
2. 内部依赖（项目内模块）及调用关系
3. 潜在的循环依赖风险
4. 依赖的版本兼容性问题（如有）

请包括每个依赖的具体使用位置。
```

---

## 探索模板（大范围代码库探索）

### 功能流程探索

```
深度理解 {功能/特性} 的完整实现

请分析：
1. 入口点定位（哪些文件/函数、如何触发、文件路径:行号）
2. 完整调用链（按时间顺序：A → B → C，标注文件路径、函数名、核心操作）
3. 数据流（输入来源、处理步骤、输出去向）
4. 关键文件清单（按重要性排序、职责说明、依赖关系）

不设字数限制，包含所有发现的细节和代码示例。
```

### 模块架构探索

```
全面理解 {目录/模块} 的架构设计

请分析：
1. 结构概览（目录组织、文件分类、模块职责）
2. 核心组件（最重要的类/接口、职责交互、生命周期）
3. 依赖关系（内部依赖、外部依赖、循环依赖风险、依赖树）
4. 数据流向（组件间流动、状态管理、事件通知）
5. 架构评估（设计模式、优点、潜在问题）

提供完整分析，包含文件路径、类名、代码示例。
```

### 问题定位探索

```
定位 {问题/Bug 描述} 的根本原因

请分析：
1. 搜索结果（找到的相关文件/函数、代码摘要、筛选结果）
2. 可疑点分析（按可能性排序、详细理由、文件路径:行号 + 代码片段）
3. 逻辑验证（执行路径、边界情况、失败场景）
4. 影响范围（修改影响、依赖关系、副作用）
5. 验证建议（验证假设方法、日志/断点、测试用例）

提供完整推理，不省略中间步骤。
```

### 跨模块交互探索

```
理解 {模块A} 和 {模块B} 的交互方式

请分析：
1. 接口识别（暴露的 API/协议、公开类/函数、文档说明）
2. 调用关系（如何调用、调用时机和频率）
3. 数据传递（数据类型格式、生命周期、验证转换）
4. 耦合分析（耦合强度、依赖方向、解耦可能性）

包含完整调用示例和数据流图。
```

---

## 使用指南

### 核心原则

| 原则 | 说明 |
|-----|------|
| 要完整 | 不限字数，保留所有有价值信息 |
| 要深度 | 穷尽式分析，不能浅尝辄止 |
| 要具体 | 包含文件路径、行号、代码示例 |
| 去噪音 | 只移除 metadata 和客套话 |

### 何时使用

| 场景 | 模板 | 文件数 |
|-----|------|--------|
| 理解代码逻辑 | 代码解释 | 1-3 |
| 理解架构 | 架构分析 | 3-10 |
| 功能实现梳理 | 功能流程探索 | 5-30 |
| 模块全景分析 | 模块架构探索 | 10-40 |
| Bug 根因定位 | 问题定位探索 | 不限 |
| 模块协作分析 | 跨模块交互探索 | 10-50 |

### 输出处理（Haiku 执行）

**必须移除**：
- clink 的 metadata (duration, return_code)
- 开场白 "好的，我来分析..."
- 结束语 "综上所述..."

**必须保留**：
- 完整的分析结论和推理
- 所有发现的问题
- 具体的文件路径和行号
- 代码示例和建议
