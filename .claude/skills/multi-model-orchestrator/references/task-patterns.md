# 任务模式映射

详细的任务类型到模型组合的映射规则。

## 完整映射表

| 任务类型 | 模型组合 | 执行方式 | 说明 |
|---------|---------|---------|------|
| 代码解释 | gemini | 单次 | 利用长上下文理解 |
| 架构分析 | gemini | 单次 | 多文件关系分析 |
| 文档总结 | gemini | 单次 | 长文本压缩 |
| **功能流程探索** | **gemini** | **深度** | **5+ 文件，替代 Explore agent** |
| **模块架构探索** | **gemini** | **深度** | **10+ 文件，穷尽式分析** |
| 算法设计 | codex → claude | 串行 | 先推理后实现 |
| Bug 修复 | gemini ∥ codex → claude | 菱形 | 并行分析 + 修复 |
| 新功能 | gemini ∥ codex → claude → codex | 菱形+验证 | 完整流程 |
| 重构 | gemini → claude → codex | 串行验证 | 理解后重构后验证 |
| 代码审查 | gemini ∥ codex | 并行 | 多角度审查 |
| **代码质量关卡** | **codex** | **验证** | **合并前最终验证** |
| **并发代码验证** | **codex** | **深度推理** | **竞态条件穷尽分析** |
| **性能瓶颈分析** | **codex** | **推理** | **推理根因而非仅测量** |
| **重构等价验证** | **codex** | **对比** | **确保行为一致** |
| 简单修改 | claude | 直接 | 无需外部模型 |

## 复杂度判断标准

### 简单任务（Claude 直接处理）
- 单文件修改
- 明确的修改点
- 无算法/逻辑复杂度
- 用户给出了具体指令

### 中等任务（单模型辅助）
- 需要理解 2-3 个文件
- 有一定逻辑但不复杂
- 需要解释或总结

### 复杂任务（多模型协作）
- 涉及 4+ 个文件
- 算法/架构设计
- 存在多种可行方案
- 需要验证正确性

## Prompt 模板

详见 `prompt-templates.md`，该文件提供完整的模板库。

## 降级策略

| 情况 | 处理 |
|-----|------|
| Gemini 调用失败 | 用 Codex 替代分析 |
| Codex 调用失败 | Claude 自行推理 |
| 两者都失败 | Claude 独立完成，标注"未经外部验证" |
| 响应超时 | 重试一次，仍失败则降级 |
