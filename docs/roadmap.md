# Roadmapï¼ˆç‰ˆæœ¬è§„åˆ’ï¼‰

## äº§å“å®šä½

- **å·¥å…·å®šä½**ï¼šä¸ªäººåŸºé‡‘æŠ•èµ„çš„"å½±å­è®°è´¦ + å†³ç­–è¾…åŠ©ç³»ç»Ÿ"
- **äº¤æ˜“å¹³å°**ï¼šå›½å†…å¹³å°ï¼ˆä¼˜å…ˆæ”¯ä»˜å®ï¼‰
- **åŒæ­¥æ¨¡å¼**ï¼šä¼ªåŒæ­¥â€”â€”ç”¨æˆ·åœ¨å¹³å°å®Œæˆæ“ä½œåæ‰‹åŠ¨å½•å…¥
- **æŠ¥å‘Šå£å¾„**ï¼šåŸºäºå®˜æ–¹æ—¥åº¦å‡€å€¼
- **AI å®šä½**ï¼šå½“å‰ä»…åšæ•°æ®å‡†å¤‡ï¼Œä¸å®ç° AI å†³ç­–

### æ ¸å¿ƒè®¾è®¡åŸåˆ™

**ç®—æ³•å¤„ç†äº‹å®ï¼ŒAI å¤„ç†è¯­ä¹‰ã€‚** è¯¦è§ `CLAUDE.md`"ç®—æ³• vs AI åˆ†å·¥"èŠ‚ã€‚

## ç‰ˆæœ¬æ€»è§ˆ

| ç‰ˆæœ¬ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| v0.1 - v0.3 | âœ… å·²å®Œæˆ | MVP åŸºç¡€åŠŸèƒ½ + æ—¥å†ç­–ç•¥ |
| v0.3.1 | âœ… å·²å®Œæˆ | æ¶æ„ç®€åŒ–ï¼ˆç›®å½•é‡æ„ã€ä¾èµ–æ³¨å…¥ï¼‰ |
| v0.3.2 | âœ… å·²å®Œæˆ | é…ç½®ç®¡ç† CLIï¼ˆè¡¥é½ç”¨æˆ·é—­ç¯ï¼‰ |
| v0.3.3 | âœ… å·²å®Œæˆ | å†å¹³è¡¡ç‹¬ç«‹ CLI + åŸºé‡‘å»ºè®® |
| v0.3.4+ | âœ… å·²å®Œæˆ | é—­ç¯å®Œå–„ï¼ˆæœˆåº¦å®šæŠ• + æ‰‹åŠ¨ç¡®è®¤ï¼‰ |
| v0.4 | âœ… å·²å®Œæˆ | è¡Œä¸ºæ•°æ®åŸºå»ºï¼ˆaction_log è¡¨ï¼‰ |
| v0.4.1 | âœ… å·²å®Œæˆ | è¡Œä¸ºæ•°æ®å¢å¼ºï¼ˆIntent + æŸ¥è¯¢ï¼‰ |
| v0.4.2 | âœ… å·²å®Œæˆ | å†å²è´¦å•å¯¼å…¥ + CLI æ ‡å‡†åŒ– |
| v0.4.3 | âœ… å·²å®Œæˆ | DCA è§„åˆ™å±‚å®šå‹ï¼ˆå›å¡« + æ¨æ–­ + äº‹å®å¿«ç…§ï¼‰ |
| v0.4.4 | âœ… å·²å®Œæˆ | é™é¢å…¬å‘Š Facts ç³»ç»Ÿï¼ˆAKShare å®æ—¶é™é¢æŸ¥è¯¢ï¼‰ |
| v0.4.5+ | ğŸ”œ å¾…è§„åˆ’ | è¡Œä¸ºåˆ†æï¼ˆå‘¨æŠ¥/æœˆæŠ¥ï¼‰ |
| v0.5 | ğŸ”œ å¾…è§„åˆ’ | å…¬å‘Š PDF è§£æ + å†å²é™é¢æ—¶é—´çº¿ |
| v0.6+ | ğŸ”® å¾…è§„åˆ’ | æ•°æ®å¯é æ€§å¢å¼º |
| v1.x+ | ğŸ”® è¿œæœŸ | AI è¾…åŠ©å†³ç­– |

---

## å·²å®Œæˆç‰ˆæœ¬ï¼ˆv0.1 - v0.4.4ï¼‰

æ‰€æœ‰ v0.1 åˆ° v0.4.4 çš„åŠŸèƒ½å·²å®Œæˆå¹¶æŠ•å…¥ä½¿ç”¨ã€‚è¯¦ç»†å®Œæˆå†…å®¹è§ `docs/coding-log.md`ã€‚

**æ ¸å¿ƒé‡Œç¨‹ç¢‘**ï¼š
- v0.1-v0.3ï¼šMVP åŸºç¡€åŠŸèƒ½ + æ—¥å†ç­–ç•¥
- v0.3.1ï¼šæ¶æ„ç®€åŒ–ï¼ˆä¾èµ–æ³¨å…¥ï¼‰
- v0.3.2-v0.3.4ï¼šé…ç½®ç®¡ç† + é—­ç¯å®Œå–„
- v0.4-v0.4.1ï¼šè¡Œä¸ºæ•°æ®åŸºå»ºï¼ˆaction_logï¼‰
- v0.4.2ï¼šå†å²è´¦å•å¯¼å…¥ + CLI æ ‡å‡†åŒ–
- v0.4.3ï¼šDCA è§„åˆ™å±‚å®šå‹ï¼ˆImport Batch + DCA å›å¡«/æ¨æ–­ï¼‰
- v0.4.4ï¼šé™é¢å…¬å‘Š Facts ç³»ç»Ÿï¼ˆAKShare å®æ—¶é™é¢æŸ¥è¯¢ï¼‰

---

## v0.4.3ï¼ˆDCA è§„åˆ™å±‚å®šå‹ï¼Œå·²å®Œæˆï¼‰

**æ ¸å¿ƒç›®æ ‡**ï¼šå®Œå–„ DCA å›å¡«é€»è¾‘ï¼Œå®ç°"è§„åˆ™ç®—äº‹å®ï¼ŒAI åšè§£é‡Š"åˆ†å·¥åŸåˆ™ã€‚

- [x] Import Batch æœºåˆ¶ï¼ˆæ‰¹æ¬¡è¿½æº¯å’Œæ’¤é”€ï¼‰
- [x] DCA å›å¡«å·¥å…·ï¼ˆ`dca_plan backfill`ï¼‰ï¼šæ—¥æœŸ+åŒæ—¥å”¯ä¸€æ€§å†³å®šå½’å±ï¼Œé‡‘é¢åªç®—åå·®
- [x] DCA æ¨æ–­å·¥å…·ï¼ˆ`dca_plan infer`ï¼‰ï¼šä»å†å²æ•°æ®æ¨æ–­å®šæŠ•è®¡åˆ’è‰æ¡ˆï¼ˆdraft_*() è§„èŒƒï¼‰
- [x] DCA äº‹å®å¿«ç…§ï¼ˆ`FundDcaFacts`ï¼‰ï¼šäº¤æ˜“åˆ†å¸ƒ + é—´éš”ç»Ÿè®¡ + ç‰¹æ®Šäº¤æ˜“æ ‡è®°
- [x] é¢†åŸŸå‘½åè§„èŒƒè½åœ°ï¼ˆ`*Draft` / `*Check` / `*Flag` è§„èŒƒï¼‰
- [x] äº¤æ˜“æ—¥å†é›†æˆï¼ˆCalendarService ä¼˜åŒ–æ¨æ–­ç²¾åº¦ï¼‰

**å…³é”®è®¾è®¡**ï¼š
- å›å¡«ï¼šæ—¥æœŸåŒ¹é… + åŒæ—¥å”¯ä¸€æ€§ â†’ å½’å±
- é‡‘é¢ï¼šåªç®—åå·®äº‹å®ï¼ˆamount_deviationï¼‰ï¼Œä¸åšè¯­ä¹‰åˆ¤æ–­
- æ¨æ–­ï¼šè¿”å›è‰æ¡ˆï¼ˆDcaPlanDraftï¼‰ï¼Œä¸è‡ªåŠ¨å†™åº“

---

## v0.4.4ï¼ˆé™é¢å…¬å‘Š Facts ç³»ç»Ÿï¼Œå·²å®Œæˆï¼‰

**æ ¸å¿ƒç›®æ ‡**ï¼šä¸º AI åˆ†æé¢„ç•™"å¤–éƒ¨çº¦æŸäº‹å®"è¾“å…¥ï¼ŒåŒºåˆ†"è¢«é™é¢ vs ä¸»åŠ¨è°ƒæ•´"ã€‚

**å·²å®ŒæˆåŠŸèƒ½**ï¼š
- [x] Schema è®¾è®¡ï¼š`fund_restrictions` è¡¨ï¼ˆdaily_limit / suspend / resumeï¼‰
- [x] æ•°æ®æ¨¡å‹ï¼š`FundRestrictionFact` + `ParsedRestriction`ï¼ˆä¸­é—´ç»“æœï¼‰
- [x] AKShare é›†æˆï¼š`FundDataClient.get_trading_restriction()`ï¼ˆæŸ¥è¯¢å½“å‰å‡†ç¡®é™é¢ï¼‰
- [x] æ•°æ®è®¿é—®å±‚ï¼š`FundRestrictionRepo`ï¼ˆadd / list_active_on / list_by_period / end_latest_activeï¼‰
- [x] CLI å·¥å…·ï¼š`fund_restriction` å‘½ä»¤ï¼ˆcheck-status / add / endï¼‰

**æœ€ç»ˆæ–¹æ¡ˆ**ï¼š
```
æ ¸å¿ƒå‘½ä»¤ï¼ˆ3 ä¸ªï¼‰ï¼š
1. check-status  â† AKShare æŸ¥è¯¢å½“å‰å‡†ç¡®é™é¢ï¼ˆä¸»åŠŸèƒ½ï¼‰
2. add           â† æ‰‹åŠ¨å½•å…¥ç‰¹æ®Šæƒ…å†µï¼ˆå…œåº•ï¼‰
3. end           â† ç»“æŸé™åˆ¶è®°å½•ï¼ˆç”Ÿå‘½å‘¨æœŸï¼‰
```

**æ•°æ®æº**ï¼š
- AKShare fund_purchase_emï¼ˆä¸»æºï¼‰- å½“å‰çŠ¶æ€ + å‡†ç¡®é™é¢ï¼Œç½®ä¿¡åº¦=high
- æ‰‹åŠ¨å½•å…¥ï¼ˆå…œåº•ï¼‰- ç‰¹æ®Šæƒ…å†µè¡¥å……

**è®¾è®¡æ•™è®­**ï¼š
- å…¬å‘Šæ ‡é¢˜è§£æä¸ç¨³å®šï¼ˆé‡‘é¢åœ¨ PDF æ­£æ–‡ä¸­ï¼‰ï¼Œå·²åˆ é™¤
- èšç„¦å•ä¸€å¯é æ•°æ®æºæ¯”å¤šä¸ªæ¨¡ç³Šæ¥æºæ›´æœ‰æ•ˆ

---

## v0.5ï¼ˆå…¬å‘Š PDF è§£æ + å†å²é™é¢æ—¶é—´çº¿ï¼Œå¾…è§„åˆ’ï¼‰

**æ ¸å¿ƒç›®æ ‡**ï¼šæ„å»ºå®Œæ•´çš„å†å²é™é¢æ—¶é—´çº¿ï¼Œè¡¥å…… AKShare "å½“å‰çŠ¶æ€å¿«ç…§"çš„ä¸è¶³ã€‚

**Phase Aï¼šPDF è§£æåŸºç¡€èƒ½åŠ›**ï¼š
- [ ] æ‰¹é‡æŠ“å–åŸºé‡‘å…¬å‘Š PDF/HTML æ­£æ–‡ï¼ˆEastmoneyAnnouncementClient æ‰©å±•ï¼‰
- [ ] ä½¿ç”¨ GPT-4 API æå–å…³é”®ä¿¡æ¯ï¼š
  - é™åˆ¶ç±»å‹ï¼ˆdaily_limit / suspend / resumeï¼‰
  - èµ·å§‹æ—¥æœŸï¼ˆç²¾ç¡®åˆ°æ—¥ï¼‰
  - ç»“æŸæ—¥æœŸï¼ˆè‹¥æœ‰ï¼‰
  - æ—¥ç´¯è®¡ç”³è´­é™é¢ï¼ˆå¦‚ 100 å…ƒã€10 å…ƒï¼‰
- [ ] ç”Ÿæˆ `ParsedRestriction` è‰ç¨¿ï¼Œç½®ä¿¡åº¦è¯„ä¼°ï¼ˆhigh / medium / lowï¼‰
- [ ] äº¤äº’å¼ç¡®è®¤æµç¨‹ï¼ˆç±»ä¼¼ check-status --applyï¼‰

**Phase Bï¼šå†å²æ•°æ®å›å¡«**ï¼š
- [ ] ä¸ºå·²æœ‰åŸºé‡‘æ‰¹é‡è§£æå†å²å…¬å‘Šï¼ˆæ—¶é—´èŒƒå›´ï¼šæœ€è¿‘ 1-2 å¹´ï¼‰
- [ ] è‡ªåŠ¨è¯†åˆ«é‡å¤è®°å½•ï¼Œé¿å…æ’å…¥å†—ä½™æ•°æ®
- [ ] æ„å»ºå®Œæ•´æ—¶é—´çº¿ï¼šstart_date + end_date è¦†ç›–å†å²é™é¢å˜æ›´

**Phase Cï¼šæ—¶é—´çº¿æŸ¥è¯¢ä¸åˆ†æ**ï¼š
- [ ] `fund_restriction timeline --fund XXX`ï¼šå±•ç¤ºå†å²é™é¢æ—¶é—´çº¿
- [ ] ä¸ DCA åˆ†æé›†æˆï¼šæŸ¥è¯¢"æŸç¬”äº¤æ˜“æ˜¯å¦å¤„äºé™é¢æœŸ"
- [ ] AI Context æ‰©å±•ï¼šåˆå¹¶ TradingStatusï¼ˆå½“å‰ï¼‰+ Timelineï¼ˆå†å²ï¼‰

**Phase Dï¼ˆå¯é€‰ï¼‰ï¼šå®šæœŸåŒæ­¥**ï¼š
- [ ] å®šæ—¶ä»»åŠ¡ï¼šæ¯å‘¨åŒæ­¥æœ€æ–°å…¬å‘Šï¼Œè‡ªåŠ¨æ›´æ–°é™åˆ¶è®°å½•
- [ ] å¢é‡è§£æï¼šåªå¤„ç†æ–°å‘å¸ƒçš„å…¬å‘Šï¼Œé¿å…é‡å¤

**æŠ€æœ¯é€‰å‹**ï¼š
- PDF è§£æï¼šä½¿ç”¨ GPT-4o æˆ– Claude 3.5 Sonnetï¼ˆè§† API æˆæœ¬å’Œæ•ˆæœå†³å®šï¼‰
- æç¤ºè¯å·¥ç¨‹ï¼šç»“æ„åŒ–è¾“å‡ºï¼ˆJSON Schemaï¼‰ï¼Œæé«˜å‡†ç¡®ç‡
- é”™è¯¯å¤„ç†ï¼šè§£æå¤±è´¥æ—¶é™çº§ä¸ºäººå·¥å½•å…¥

**æˆæœ¬é¢„ä¼°**ï¼ˆå‡è®¾ä½¿ç”¨ GPT-4oï¼‰ï¼š
- å•æ¡å…¬å‘Šè§£ææˆæœ¬ï¼š~$0.01-0.02ï¼ˆå–å†³äºå…¬å‘Šé•¿åº¦ï¼‰
- æ‰¹é‡å›å¡« 100 åªåŸºé‡‘ï¼ˆæ¯åª 10 æ¡å…¬å‘Šï¼‰ï¼š~$10-20
- å¢é‡åŒæ­¥ï¼ˆæ¯å‘¨æ–°å¢ ~5 æ¡ï¼‰ï¼š~$0.05-0.10/å‘¨

**ä¼˜å…ˆçº§**ï¼šä¸­ç­‰ï¼ˆå½“å‰ AKShare å·²æ»¡è¶³å®æ—¶éœ€æ±‚ï¼Œå†å²æ•°æ®ç”¨äºå®Œå–„ AI åˆ†æï¼‰

---

## v0.4.5+ï¼ˆè¡Œä¸ºåˆ†æï¼Œå¾…è§„åˆ’ï¼‰

- [ ] ActionLog v2ï¼šæ·±åº¦ DCA å½’å±å­—æ®µï¼ˆis_dca_execution / dca_plan_key / dca_tag_sourceï¼‰
- [ ] å‘¨æŠ¥/æœˆæŠ¥ï¼ˆäº¤æ˜“é¢‘ç‡ã€å®šæŠ•æ‰§è¡Œç‡ã€intent åˆ†å¸ƒï¼‰
- [ ] `action stats` ç»Ÿè®¡æ‘˜è¦
- [ ] ContextSnapshot / Outcome è¡¨ï¼ˆæŒ‰éœ€ï¼ŒéªŒè¯é©±åŠ¨ï¼‰

---

## v0.6+ï¼ˆæ•°æ®å¯é æ€§å¢å¼ºï¼Œå¾…è§„åˆ’ï¼‰

- [ ] NAV è‡ªåŠ¨å›å¡«ï¼ˆæ£€æµ‹ç¼ºå¤±å¹¶è¡¥æŠ“ï¼‰
- [ ] å¤šæ•°æ®æºæ”¯æŒï¼ˆå¤©å¤©åŸºé‡‘ç­‰å¤‡ä»½æºï¼‰
- [ ] å†·å´æœŸæœºåˆ¶ï¼ˆé˜²æ­¢é¢‘ç¹äº¤æ˜“ï¼‰
- [ ] åˆ†çº¢å†æŠ•è¿½è¸ª

---

## v1.0+ï¼ˆAI è¡Œä¸ºå¤ç›˜ï¼Œè¿œæœŸï¼‰

**å®šä½**ï¼šä¸åšäº¤æ˜“å»ºè®®ï¼Œèšç„¦"è¡Œä¸ºå¤ç›˜ + è‡ªæˆ‘çº¦æŸå»ºè®®"

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- [ ] è‡ªç„¶è¯­è¨€æŸ¥è¯¢æ¥å£ï¼ˆåŸºäº ActionLogï¼‰
- [ ] è¡Œä¸ºæ¨¡å¼åˆ†æï¼ˆäº¤æ˜“æ—¶æœºã€æ‰§è¡Œç‡ç»Ÿè®¡ï¼‰
- [ ] è‡ªæˆ‘çº¦æŸå»ºè®®ï¼ˆä¸ªæ€§åŒ–å†·å´æœŸã€é¢‘ç¹è°ƒä»“æé†’ï¼‰

**éµå¾ª CLAUDE.md "ç®—æ³• vs AI åˆ†å·¥" åŸåˆ™**ï¼šè§„åˆ™è¾“å‡ºäº‹å®ï¼ŒAI åšè¯­ä¹‰åˆ¤æ–­ï¼Œç”¨æˆ·ç¡®è®¤ä¿®æ”¹ã€‚

---

## åŠŸèƒ½æ¸…å•

**CLI å‘½ä»¤é€ŸæŸ¥è¡¨**ï¼š`docs/operations-log.md` â†’ "CLI å‘½ä»¤é€ŸæŸ¥è¡¨"ç« èŠ‚

| åˆ†ç±» | å‘½ä»¤æ•°é‡ | æ ¸å¿ƒå‘½ä»¤ |
|------|---------|----------|
| é…ç½®ç®¡ç† | 12 | `fund` / `dca_plan` / `alloc` |
| äº¤æ˜“ç¡®è®¤ | 8 | `trade` / `confirm` / `dca` |
| æ•°æ®æŠ¥å‘Š | 5 | `fetch_navs` / `report` / `rebalance` / `market_value` |
| è¡Œä¸ºæ•°æ® | 1 | `action list` |
| æ—¥å†ç®¡ç† | 3 | `calendar` refresh/sync/patch |

è¯¦ç»†ç”¨æ³•å’Œå‚æ•°è§ `docs/operations-log.md` å„ç« èŠ‚ã€‚

---

## å…¸å‹å·¥ä½œæµ

### é¦–æ¬¡ä½¿ç”¨
```bash
# 1. åˆå§‹åŒ–æ•°æ®åº“
SEED_RESET=1 PYTHONPATH=. python -m scripts.dev_seed_db

# 2. é…ç½®åŸºé‡‘
python -m src.cli.fund add --code 000001 --name "åå¤æˆé•¿" --class CSI300 --market CN_A

# 3. è®¾ç½®å®šæŠ•è®¡åˆ’
python -m src.cli.dca_plan add --fund 000001 --amount 1000 --freq monthly --rule 1

# 4. è®¾ç½®èµ„äº§é…ç½®
python -m src.cli.alloc set --class CSI300 --target 0.6 --deviation 0.05
```

### æ—¥å¸¸è¿ç»´
```bash
# æ¯æ—¥æ‰§è¡Œï¼ˆæŒ‰é¡ºåºï¼Œæ¨èæ—©ä¸Š 9:00 æ‰§è¡Œï¼‰
python -m src.cli.dca run          # 1. æ‰§è¡Œå®šæŠ•ï¼ˆåˆ›å»ºä»Šæ—¥äº¤æ˜“ï¼‰
python -m src.cli.fetch_navs       # 2. æŠ“å–å‡€å€¼ï¼ˆé»˜è®¤ï¼šæ˜¨æ—¥ï¼Œå› ä»Šæ—¥NAVæ™šä¸Šæ‰å…¬å¸ƒï¼‰
python -m src.cli.confirm          # 3. ç¡®è®¤äº¤æ˜“ï¼ˆç¡®è®¤æ˜¨æ—¥åˆ›å»ºçš„äº¤æ˜“ï¼‰
python -m src.cli.report           # 4. ç”Ÿæˆæ—¥æŠ¥ï¼ˆé»˜è®¤ï¼šæ˜¨æ—¥æŒä»“ï¼‰

# è·³è¿‡æŸæ—¥å®šæŠ•ï¼ˆv0.4 æ–°å¢ï¼‰
python -m src.cli.dca skip --fund 000001 --note "å¸‚åœºè¿‡çƒ­ï¼Œæš‚åœå®šæŠ•"
```

> **è¯´æ˜**ï¼š`fetch_navs` å’Œ `report` é»˜è®¤å±•ç¤º"ä¸Šä¸€å·¥ä½œæ—¥"æ•°æ®ï¼Œé€‚åˆæ—©ä¸Šå®šæ—¶æ‰§è¡Œã€‚æ™šä¸Šå¯æ‰‹åŠ¨æŒ‡å®š `--date` æŸ¥çœ‹ä»Šæ—¥å‡€å€¼ã€‚è¯¦è§ `docs/operations-log.md`ã€‚

### æ‰‹åŠ¨è°ƒä»“
```bash
# 1. æŸ¥çœ‹å†å¹³è¡¡å»ºè®®
python -m src.cli.rebalance

# 2. æ‰§è¡Œäº¤æ˜“ï¼ˆv0.4ï¼šæ”¯æŒ intent å’Œ noteï¼‰
python -m src.cli.trade buy --fund 000001 --amount 5000 --intent rebalance --note "å†å¹³è¡¡è¡¥ä»“"

# 3. æŸ¥çœ‹äº¤æ˜“çŠ¶æ€
python -m src.cli.trade list --status pending
```
